{"name":"odc-send-next-message-callback","description":"Default description","uuid":"8eb4490c-dc45-4c1f-bf10-1a95158ef45f","resources":[{"values":[{"value":"@page.body.title\n\n@page.body.body.text.value.message\n","modes":["RICH_MESSAGING"],"content_type":"TEXT","mime_type":"text/plain","language_id":"35b5e073-c595-4a10-92cc-3a797b138ee8"}],"uuid":"b67bf6c2-b62e-4d2f-8697-25052ecd1a2e"}],"flows":[{"label":null,"name":"stack","blocks":[{"label":null,"name":"contentset","type":"Io.Turn.Webhook","config":{"timeout":5000,"mode":"sync","body":null,"query":[],"url":"https://content-repo-api-qa.prk-k8s.prd-p6t.org/api/v2/orderedcontent/@contact.push_messaging_content_set/","headers":[["Authorization","Token @global.config.contentrepo_token"]],"method":"GET","cache_ttl":60000},"tags":[],"uuid":"13f70cd6-081d-57f6-903c-8562b00f3fb6","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"contentset","config":{},"test":"","uuid":"44d7a13a-cbb6-4ea8-8fe2-bd0f4700b849","destination_block":"952eb2a3-039f-539d-ab01-f0836b320e0c","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":1},"name":"GetMessage","uuid":"6f4f7f0b-c111-5248-8be2-104e696b4eeb"},"card_item":{"meta":{"column":3,"line":2},"type":"webhook","webhook":{}},"index":0}}}}}},{"label":null,"name":"contentset_item","type":"Core.Case","config":{},"tags":[],"uuid":"952eb2a3-039f-539d-ab01-f0836b320e0c","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"contentset.body.pages[contact.push_messaging_content_set_position]","config":{},"test":"","uuid":"68b5ef83-cb31-43c2-a7ee-75ef2ac0fbaf","destination_block":"088cd6c4-92f9-58c1-9a8b-bd069be737d9","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":1},"name":"GetMessage","uuid":"6f4f7f0b-c111-5248-8be2-104e696b4eeb"},"card_item":{"expression":{},"meta":{"column":3,"line":10},"type":"expression"},"index":0}}}}}},{"label":null,"name":"page","type":"Io.Turn.Webhook","config":{"timeout":5000,"mode":"sync","body":null,"query":[["whatsapp","true"]],"url":"https://content-repo-api-qa.prk-k8s.prd-p6t.org/api/v2/pages/@contentset_item.id/","headers":[["Authorization","Token @global.config.contentrepo_token"]],"method":"GET","cache_ttl":60000},"tags":[],"uuid":"088cd6c4-92f9-58c1-9a8b-bd069be737d9","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"Default exit to \"SendMessage\"","config":{},"test":"","uuid":"fe72315d-ea89-4188-96b8-4f7a1ac7f1a8","destination_block":"4a33bb3c-ce05-5ffc-a22a-aedae889d235","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":1},"name":"GetMessage","uuid":"6f4f7f0b-c111-5248-8be2-104e696b4eeb"},"card_item":{"meta":{"column":3,"line":12},"type":"webhook","webhook":{}},"index":0}}}}}},{"label":null,"name":"schedule_next_message_contact_update_push_messaging_content_set_position","type":"Core.SetContactProperty","config":{"set_contact_property":{"property_key":"push_messaging_content_set_position","property_value":"@(contact.push_messaging_content_set_position + 1)"}},"tags":[],"uuid":"f8b48d63-17e7-5be1-aeb4-ae59452ea22a","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"schedule_next_message_contact_update_push_messaging_content_set_position","config":{},"test":"","uuid":"a128b7cd-d60a-4d94-b10d-8d20a6999e7c","destination_block":"9f360c2c-2e98-543a-8515-1463951bc4e8","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":41},"name":"ScheduleNextMessage","uuid":"7f247ac5-8884-504a-9f4b-74fdf1c28840"},"card_item":{"meta":{"column":3,"line":42},"type":"update_contact","update_contact":{}},"index":0}}}}}},{"label":null,"name":"schedule_next_message_run_stack","type":"Core.RunFlow","config":{"flow_id":"f291b782-72d3-49eb-8434-e47e388c2ea1"},"tags":[],"uuid":"9f360c2c-2e98-543a-8515-1463951bc4e8","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"schedule_next_message_run_stack","config":{},"test":"","uuid":"9ec4b824-b640-4801-bfc9-28b0b321dffc","destination_block":null,"semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":41},"name":"ScheduleNextMessage","uuid":"7f247ac5-8884-504a-9f4b-74fdf1c28840"},"card_item":{"meta":{"column":3,"line":47},"run_stack":{},"type":"run_stack"},"index":0}}}}}},{"label":null,"name":"send_message_case","type":"Core.Case","config":{},"tags":[],"uuid":"4a33bb3c-ce05-5ffc-a22a-aedae889d235","ui_metadata":{},"exits":[{"default":false,"name":"Exit for send_message_case_condition_0","config":{},"test":"page.body.body.is_whatsapp_template","uuid":"2048ac05-f1b2-4428-b778-412cd113b815","destination_block":"7c4e852a-5293-5fa3-a02e-5f5b6f37d76b","semantic_label":null,"vendor_metadata":{}},{"default":true,"name":"Exit for send_message_case_condition_1","config":{},"test":null,"uuid":"12226865-2081-4634-91fa-9bf305183297","destination_block":"373475d1-7f73-5db4-be43-481760e2ce92","semantic_label":null,"vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{}},{"label":null,"name":"message_sent","type":"Core.Output","config":{"value":"\"@page.body.id\""},"tags":[],"uuid":"373475d1-7f73-5db4-be43-481760e2ce92","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"message_sent","config":{},"test":"","uuid":"a276837a-0c31-42b9-8e1e-cff637c5381e","destination_block":"1474d567-3b5b-5b43-a26a-b0da3a20563e","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":31},"name":"SendMessage","uuid":"b2c3e2ca-ba63-5954-bcc6-346d54f6e74e"},"card_item":{"meta":{"column":3,"line":32},"type":"write_result","write_result":{}},"index":1}}}}}},{"label":null,"name":"send_message_case_condition_1_text","type":"MobilePrimitives.Message","config":{"prompt":"b67bf6c2-b62e-4d2f-8697-25052ecd1a2e"},"tags":[],"uuid":"1474d567-3b5b-5b43-a26a-b0da3a20563e","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"Default exit to \"ScheduleNextMessage\"","config":{},"test":"","uuid":"11a6dd5c-595f-4141-a97a-ea3883ccd83a","destination_block":"f8b48d63-17e7-5be1-aeb4-ae59452ea22a","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":null,"meta":{"column":1,"line":31},"name":"SendMessage","uuid":"b2c3e2ca-ba63-5954-bcc6-346d54f6e74e"},"card_item":{"meta":{"column":3,"line":34},"text":{},"type":"text"},"index":0}}}}}},{"label":null,"name":"template_sent","type":"Core.Output","config":{"value":"\"@page.body.body.whatsapp_template_name\""},"tags":[],"uuid":"7c4e852a-5293-5fa3-a02e-5f5b6f37d76b","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"template_sent","config":{},"test":"","uuid":"cd43926c-7b01-4e67-84cc-8665b7d76165","destination_block":"e2a3909b-e829-55a0-b52d-20aaca46f855","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":"page.body.body.is_whatsapp_template","meta":{"column":1,"line":22},"name":"SendMessage","uuid":"4a33bb3c-ce05-5ffc-a22a-aedae889d235"},"card_item":{"meta":{"column":3,"line":23},"type":"write_result","write_result":{}},"index":0}}}}}},{"label":null,"name":"send_message_case_condition_0_whatsapp_template_message","type":"Io.Turn.WhatsAppTemplateMessage","config":{"template":{"name":"\"@page.body.body.whatsapp_template_name\"","components":[{"index":null,"type":"body","parameters":[{"type":"text","text":"\"@contact.whatsapp_profile_name\""},{"type":"text","text":"\"Second\""}],"sub_type":null}],"language":{"code":"\"en_US\""},"tracking":null}},"tags":[],"uuid":"e2a3909b-e829-55a0-b52d-20aaca46f855","ui_metadata":{"canvas_coordinates":{"x":0,"y":0}},"exits":[{"default":true,"name":"Default exit to \"ScheduleNextMessage\"","config":{},"test":"","uuid":"de9d7472-b854-4a53-9a83-ca182559cc0a","destination_block":"f8b48d63-17e7-5be1-aeb4-ae59452ea22a","semantic_label":"","vendor_metadata":{}}],"semantic_label":null,"vendor_metadata":{"io":{"turn":{"stacks_dsl":{"0.1.0":{"card":{"condition":"page.body.body.is_whatsapp_template","meta":{"column":1,"line":22},"name":"SendMessage","uuid":"4a33bb3c-ce05-5ffc-a22a-aedae889d235"},"card_item":{"meta":{"column":3,"line":25},"type":"whatsapp_template_message","whatsapp_template_message":{}},"index":0}}}}}}],"last_modified":"2024-10-09T14:34:21.036895Z","uuid":"cd151682-0f27-58a0-a7b3-281620f3513d","languages":[{"id":"35b5e073-c595-4a10-92cc-3a797b138ee8","label":"English","variant":null,"iso_639_3":"eng","bcp_47":null}],"first_block_id":"13f70cd6-081d-57f6-903c-8562b00f3fb6","interaction_timeout":300,"vendor_metadata":{},"supported_modes":["RICH_MESSAGING"],"exit_block_id":""}],"vendor_metadata":{},"specification_version":"1.0.0-rc3"}